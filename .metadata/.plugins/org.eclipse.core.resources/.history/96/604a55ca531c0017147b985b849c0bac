package org.rachel.tinkerpop3;

import java.text.DateFormat;
import java.text.ParseException;
import java.text.SimpleDateFormat;

import org.apache.tinkerpop.gremlin.process.traversal.dsl.graph.GraphTraversalSource;
import org.apache.tinkerpop.gremlin.structure.Graph;
import org.apache.tinkerpop.gremlin.structure.Vertex;
import org.apache.tinkerpop.gremlin.tinkergraph.structure.TinkerGraph;

public class Demo {

	public static void main(String[] args) throws ParseException {
		// TODO Auto-generated method stub
		// build the graph
		DateFormat df = new SimpleDateFormat("MM dd kk:mm:ss yyyy");
		Graph g = TinkerGraph.open();
		Vertex v1 = g.addVertex("id", "id1", "name", "name1", "createdDate", df.parse("01 22 11:31:13 2011"));
		Vertex v2 = g.addVertex("id", "id2", "name", "name2", "createdDate", df.parse("02 22 11:31:13 2011"));
		Vertex v3 = g.addVertex("id", "id3", "name", "name3", "createdDate", df.parse("03 22 11:31:13 2011"));
		Vertex v4 = g.addVertex("id", "id4", "name", "name4", "createdDate", df.parse("04 22 11:31:13 2011"));

		v1.addEdge("infoflow", v2, "id", "edgeId12", "numOfMessage", 10);
		v1.addEdge("infoflow", v3, "id", "edgeId13", "numOfMessage", 5);
		v1.addEdge("infoflow", v4, "id", "edgeId14", "numOfMessage", 30);

		v2.addEdge("infoflow", v3, "id", "edgeId23", "numOfMessage", 140);
		v2.addEdge("infoflow", v4, "id", "edgeId24", "numOfMessage", 1);

		v3.addEdge("infoflow", v4, "id", "edgeId34", "numOfMessage", 111);

		// traverse and query the graph
		GraphTraversalSource s = g.traversal();
		System.out.println("===========begin==========");
		//g.V().out("knows").map(t -> t.get().value("name") + " is the friend name") 
		System.out.println(s.V().out("infoflow").toList());
		System.out.println("===========end==========");
	}

}
